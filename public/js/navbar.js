import{isJson,ht,URL,newTokenData}from"./script.js";const navToggler=document.querySelector("#nav-toggle-mobile"),navbar=document.querySelector(".navbar"),nav2Toggler=document.querySelector("#toggle-nav-2");navToggler.addEventListener("click",function(){nav2Toggler.click()});const searchCombo=document.querySelector(".search-combo"),searchInput=document.querySelector("#nav-search-input"),mobileInput=document.querySelector(".mobile-search-input"),results_1=document.querySelector(".search-results-1"),results_2=document.querySelector(".search-results-2");document.addEventListener("DOMContentLoaded",function(){searchInput.value="",mobileInput.value=""}),document.addEventListener("keydown",function(e){e.ctrlKey&&"/"===e.key?searchInput.focus():"Escape"===e.key&&(searchInput.blur(),searchInput.value=searchInput.value)}),document.querySelectorAll(".user-dropdown-menu").forEach(e=>{e.addEventListener("click",function(e){e.stopPropagation()})}),searchCombo.addEventListener("click",function(){searchInput.focus()}),searchInput.addEventListener("focus",function(){searchCombo.style.display="none",searchInput.placeholder=""}),searchInput.addEventListener("blur",function(){setTimeout(()=>{searchInput.value||(searchInput.placeholder="           Search",searchCombo.style.display="inline"),results_1.style.display="none"},200)}),mobileInput.addEventListener("focus",function(){searchInput.placeholder=""}),mobileInput.addEventListener("blur",function(){setTimeout(()=>{mobileInput.value||(mobileInput.placeholder="Search"),results_2.style.display="none"},200)});const arr=[mobileInput,searchInput];function liveResults(){""!==this.value.trim()?(results_1.style.display="block",results_2.style.display="block",fetch(`${URL}/ajax/explore/live-search/${this.value}`,{method:"POST",body:newTokenData()}).then(e=>e.text()).then(e=>{const t=`${URL}/explore/search?q=${this.value}`;document.querySelectorAll(".results-users-link").forEach(e=>e.setAttribute("href",`${t}&type=users`)),document.querySelectorAll(".results-articles-link").forEach(e=>e.setAttribute("href",`${t}&type=articles`)),e=JSON.parse(e),document.querySelectorAll(".user-results-container").forEach(e=>e.innerHTML=""),e.users.forEach(e=>{document.querySelectorAll(".user-results-container").forEach(t=>{t.innerHTML+=`\n                    <a href="${URL}/profile?u=${e.username}" class='text-decoration-none text-dark row m-0 mb-2 user-result-box'>\n                        <div class="col-3 text-center">\n                            <div class="user-result" style="background-image: url(${URL}/uploads/${e.profile_img});">\n                            </div>\n                        </div>\n                        <div class="col-9">\n                            <div class='mb-0 pb-0'>${ht(e.display_name,20)}</div>\n                            <small class="text-muted p-0 m-0">@${ht(e.username)}</small>\n                        </div>\n                    </a>`})}),document.querySelectorAll(".articles-results-container").forEach(e=>e.innerHTML=""),e.articles.forEach(e=>{document.querySelectorAll(".articles-results-container").forEach(t=>{t.innerHTML+=`\n                    <a href="${URL}/article?a=${e.article_id}" class='text-decoration-none text-dark row m-0 mb-2 user-result-box'>\n                        <b>${ht(e.title,20)}</b>\n                        <small class="text-muted">${ht(e.tagline,30)}</small>\n                    </a>\n                    `})})})):(results_1.style.display="none",results_2.style.display="none")}arr.forEach(e=>{e.addEventListener("input",liveResults)});