import{isJson,newTokenData,URL,addFormErrors,removeFormErrors}from"./script.js";const saveBtn=document.querySelector("#save");saveBtn.addEventListener("click",()=>{const e=document.querySelector("[name='username']").value,r=document.querySelector("[name='display_name']").value,a=document.querySelector("[name='about']").value,o=newTokenData({username:e,display_name:r,about:a}),t=document.querySelector("[name='image']");t.value&&o.append("image",t.files[0]),fetch(`${URL}/ajax/settings/update-profile`,{method:"POST",body:o}).then(e=>e.text()).then(e=>{if(isJson(e)){let r=JSON.parse(e);200===r.status?(removeFormErrors(r),location.replace(`${URL}/home`)):addFormErrors(r)}})});const uploader=document.querySelector("#image");uploader.addEventListener("change",()=>{if(uploader.files&&uploader.files[0]){const e=new FileReader;e.onload=function(e){document.querySelector("#preview-img").style.backgroundImage=`url(${e.target.result})`},e.readAsDataURL(uploader.files[0])}});